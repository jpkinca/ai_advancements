# AI Trading Database Tables - Field Reference Guide

## Complete Field Documentation for All Tables

---

## Table 1: `ai_models` - AI Model Registry

**Purpose**: Central registry for all AI trading models with their configurations and metadata.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `model_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Model Identifier** - Auto-generated UUID for each model instance |
| `model_name` | VARCHAR(100) | NOT NULL | **Human-Readable Name** - Descriptive name like "PPOTrader_AAPL_v2" or "GeneticOptimizer_Portfolio" |
| `model_type` | VARCHAR(50) | NOT NULL | **Primary Category** - Main AI type: 'reinforcement_learning', 'genetic_optimization', 'sparse_spectrum' |
| `model_subtype` | VARCHAR(50) | NULL | **Specific Implementation** - Algorithm details: 'ppo', 'fourier', 'wavelet', 'parameter_optimizer' |
| `version` | VARCHAR(20) | NOT NULL, DEFAULT '1.0.0' | **Version Control** - Model version for tracking updates and rollbacks |
| `description` | TEXT | NULL | **Detailed Description** - Full explanation of model purpose, methodology, and expected use cases |
| `configuration` | JSONB | NOT NULL | **Model Parameters** - All hyperparameters, settings, and configuration as JSON object |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Creation Timestamp** - When model was first registered in the system |
| `updated_at` | TIMESTAMPTZ | DEFAULT NOW() | **Last Modified** - Timestamp of most recent configuration change |
| `is_active` | BOOLEAN | DEFAULT TRUE | **Active Status** - Whether model is currently enabled for trading operations |
| `performance_metrics` | JSONB | NULL | **Latest Performance** - Most recent performance summary for quick reference |

**Unique Constraint**: `(model_name, version)` - Prevents duplicate model versions

---

## Table 2: `training_sessions` - Training History Tracking

**Purpose**: Track all model training runs with detailed metrics and artifacts.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `session_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Session Identifier** - Auto-generated ID for each training run |
| `model_id` | UUID | NOT NULL, FOREIGN KEY → ai_models(model_id) | **Model Reference** - Links training session to specific model |
| `session_name` | VARCHAR(100) | NULL | **Descriptive Session Name** - Human-readable identifier like "AAPL_training_2025Q3" |
| `start_time` | TIMESTAMPTZ | DEFAULT NOW() | **Training Start** - When training process began |
| `end_time` | TIMESTAMPTZ | NULL | **Training End** - When training completed (NULL if still running) |
| `status` | VARCHAR(20) | DEFAULT 'running' | **Training Status** - Current state: 'running', 'completed', 'failed', 'stopped' |
| `training_data_period` | DATERANGE | NULL | **Training Data Range** - Start and end dates of data used for training |
| `validation_data_period` | DATERANGE | NULL | **Validation Data Range** - Start and end dates of data used for validation |
| `hyperparameters` | JSONB | NULL | **Training Parameters** - Learning rates, batch sizes, epochs, etc. specific to this session |
| `training_metrics` | JSONB | NULL | **Training Progress** - Loss curves, reward progressions, convergence indicators |
| `final_performance` | JSONB | NULL | **Final Results** - End-of-training metrics like accuracy, Sharpe ratio, total reward |
| `model_artifacts_path` | TEXT | NULL | **Model File Location** - Path to saved model weights, checkpoints, and artifacts |
| `error_message` | TEXT | NULL | **Error Details** - Detailed error information if training failed |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When training session record was created |

---

## Table 3: `ai_signals` - Trading Signal Generation

**Purpose**: Store all trading signals generated by AI models with confidence scores and targets.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `signal_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Signal Identifier** - Auto-generated ID for each trading signal |
| `model_id` | UUID | NOT NULL, FOREIGN KEY → ai_models(model_id) | **Source Model** - Which AI model generated this signal |
| `symbol` | VARCHAR(20) | NOT NULL | **Trading Symbol** - Stock ticker (AAPL, GOOGL) or instrument identifier |
| `signal_type` | VARCHAR(10) | NOT NULL | **Action Type** - Trading action: 'BUY', 'SELL', 'HOLD' |
| `confidence` | DECIMAL(5,4) | NOT NULL, CHECK (0 ≤ confidence ≤ 1) | **Model Confidence** - Probability score from 0.0000 to 1.0000 |
| `price_target` | DECIMAL(15,6) | NOT NULL | **Target Price** - Expected price level for the signal |
| `stop_loss` | DECIMAL(15,6) | NULL | **Stop Loss Level** - Risk management price level |
| `take_profit` | DECIMAL(15,6) | NULL | **Take Profit Level** - Profit-taking price level |
| `signal_timestamp` | TIMESTAMPTZ | NOT NULL | **Signal Generation Time** - When AI model generated the signal |
| `market_data_timestamp` | TIMESTAMPTZ | NULL | **Data Source Time** - Timestamp of market data used for signal generation |
| `metadata` | JSONB | NULL | **Additional Details** - Model-specific information, feature values, reasoning |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When signal was stored in database |

**Performance Indexes**:
- `idx_ai_signals_symbol_time`: Fast queries by symbol and chronological order
- `idx_ai_signals_model_time`: Model-specific signal history analysis
- `idx_ai_signals_type_confidence`: Filter by signal type and confidence threshold

---

## Table 4: `signal_performance` - Signal Quality Tracking

**Purpose**: Track the actual performance of generated signals for model validation.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `performance_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Performance Record** - Auto-generated ID for each performance evaluation |
| `signal_id` | UUID | NOT NULL, FOREIGN KEY → ai_signals(signal_id) | **Signal Reference** - Links back to original signal being evaluated |
| `evaluation_timestamp` | TIMESTAMPTZ | NOT NULL | **Evaluation Time** - When performance was measured |
| `actual_price` | DECIMAL(15,6) | NULL | **Market Price** - Actual market price at evaluation time |
| `price_change_pct` | DECIMAL(8,4) | NULL | **Price Change** - Percentage change from signal generation time |
| `target_hit` | BOOLEAN | NULL | **Target Achieved** - Whether the price target was reached |
| `stop_loss_hit` | BOOLEAN | NULL | **Stop Loss Triggered** - Whether stop loss level was hit |
| `holding_period_hours` | INTEGER | NULL | **Duration** - How long the signal remained relevant (in hours) |
| `pnl_if_executed` | DECIMAL(15,6) | NULL | **Theoretical P&L** - Profit/loss if signal was actually traded |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When performance evaluation was recorded |

---

## Table 5: `feature_data` - Machine Learning Features

**Purpose**: Store extracted features used by ML models for training and prediction.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `feature_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Feature Record** - Auto-generated ID for each feature extraction |
| `symbol` | VARCHAR(20) | NOT NULL | **Asset Symbol** - Trading instrument for which features were extracted |
| `timestamp` | TIMESTAMPTZ | NOT NULL | **Feature Timestamp** - Time point for which features were calculated |
| `feature_set_name` | VARCHAR(50) | NOT NULL | **Feature Category** - Type of features: 'technical_indicators', 'fourier_coefficients', 'market_microstructure' |
| `features` | JSONB | NOT NULL | **Feature Vector** - JSON object containing all feature values |
| `raw_data_hash` | VARCHAR(64) | NULL | **Data Versioning** - Hash of input market data to track data changes |
| `extraction_method` | VARCHAR(50) | NULL | **Calculation Method** - Algorithm or approach used for feature extraction |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When features were stored |

**Unique Constraint**: `(symbol, timestamp, feature_set_name)` - Prevents duplicate feature sets
**Performance Indexes**:
- `idx_feature_data_symbol_time`: Symbol-specific time series queries
- `idx_feature_data_set_time`: Feature type analysis over time

---

## Table 6: `optimization_runs` - Genetic Algorithm Results

**Purpose**: Track genetic algorithm optimization sessions and results.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `run_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Run Identifier** - Auto-generated ID for each optimization session |
| `model_id` | UUID | NULL, FOREIGN KEY → ai_models(model_id) | **Associated Model** - Links optimization to specific AI model (optional) |
| `optimization_type` | VARCHAR(50) | NOT NULL | **Optimization Category** - Type: 'parameter_optimization', 'portfolio_optimization', 'strategy_optimization' |
| `objective_function` | VARCHAR(50) | NULL | **Fitness Function** - What's being optimized: 'sharpe_ratio', 'total_return', 'max_drawdown', 'multi_objective' |
| `population_size` | INTEGER | NULL | **GA Population Size** - Number of individuals in each generation |
| `generations` | INTEGER | NULL | **Generation Count** - Number of evolutionary generations |
| `parameter_ranges` | JSONB | NULL | **Search Space** - Min/max bounds for each parameter being optimized |
| `start_time` | TIMESTAMPTZ | DEFAULT NOW() | **Optimization Start** - When genetic algorithm began |
| `end_time` | TIMESTAMPTZ | NULL | **Optimization End** - When algorithm completed |
| `status` | VARCHAR(20) | DEFAULT 'running' | **Current Status** - 'running', 'completed', 'failed', 'stopped' |
| `best_individual` | JSONB | NULL | **Optimal Solution** - Parameter values of best individual found |
| `best_fitness` | DECIMAL(15,6) | NULL | **Best Fitness Score** - Highest fitness achieved |
| `convergence_data` | JSONB | NULL | **Evolution History** - Fitness progression over generations |
| `final_population` | JSONB | NULL | **Final State** - Complete final generation for analysis |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When optimization run was registered |

---

## Table 7: `optimization_individuals` - Individual GA Solutions

**Purpose**: Store individual solutions from genetic algorithm runs for detailed analysis.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `individual_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Individual ID** - Auto-generated identifier for each GA individual |
| `run_id` | UUID | NOT NULL, FOREIGN KEY → optimization_runs(run_id) | **Optimization Run** - Links individual to specific GA run |
| `generation` | INTEGER | NOT NULL | **Generation Number** - Which evolutionary generation this individual belongs to |
| `individual_rank` | INTEGER | NULL | **Fitness Rank** - Ranking within the generation (1 = best) |
| `genes` | JSONB | NOT NULL | **Parameter Values** - The chromosome/parameter set for this individual |
| `fitness_score` | DECIMAL(15,6) | NULL | **Individual Fitness** - Performance score for this parameter combination |
| `objectives` | JSONB | NULL | **Multi-Objective Scores** - Breakdown of fitness components if multi-objective optimization |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When individual was evaluated and stored |

**Performance Indexes**:
- `idx_optimization_individuals_run_gen`: Generation-based analysis within runs
- `idx_optimization_individuals_fitness`: Fitness-based sorting and selection

---

## Table 8: `anomaly_detections` - Market Anomaly Detection

**Purpose**: Track anomalies detected by AI models for risk management and market intelligence.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `anomaly_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Anomaly ID** - Auto-generated identifier for each detected anomaly |
| `model_id` | UUID | NOT NULL, FOREIGN KEY → ai_models(model_id) | **Detector Model** - Which AI model detected the anomaly |
| `symbol` | VARCHAR(20) | NOT NULL | **Affected Symbol** - Trading instrument where anomaly was detected |
| `detection_timestamp` | TIMESTAMPTZ | NOT NULL | **Detection Time** - When anomaly was first identified |
| `anomaly_type` | VARCHAR(50) | NULL | **Anomaly Category** - Type: 'price_jump', 'volume_spike', 'pattern_break', 'correlation_shift' |
| `severity_score` | DECIMAL(8,4) | NOT NULL | **Severity Level** - How extreme the anomaly is (standard deviations from normal) |
| `confidence` | DECIMAL(5,4) | NULL | **Detection Confidence** - Model's confidence in anomaly detection (0.0-1.0) |
| `market_data_context` | JSONB | NULL | **Market Context** - Relevant market conditions at time of detection |
| `anomaly_details` | JSONB | NULL | **Specific Details** - Model-specific information about the anomaly |
| `resolved` | BOOLEAN | DEFAULT FALSE | **Resolution Status** - Whether anomaly situation has been resolved |
| `resolution_timestamp` | TIMESTAMPTZ | NULL | **Resolution Time** - When anomaly was marked as resolved |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When anomaly detection was recorded |

**Performance Indexes**:
- `idx_anomaly_detections_symbol_time`: Symbol-specific anomaly history
- `idx_anomaly_detections_severity`: Severity-based filtering and alerting
- `idx_anomaly_detections_unresolved`: Active anomaly monitoring

---

## Table 9: `model_performance` - Performance Metrics Over Time

**Purpose**: Track comprehensive model performance metrics across different time periods.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `performance_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Performance Record** - Auto-generated ID for each performance evaluation |
| `model_id` | UUID | NOT NULL, FOREIGN KEY → ai_models(model_id) | **Model Reference** - Which model's performance is being tracked |
| `evaluation_period` | DATERANGE | NOT NULL | **Time Period** - Start and end dates for performance calculation |
| `total_signals` | INTEGER | NULL | **Signal Count** - Total number of signals generated in period |
| `successful_signals` | INTEGER | NULL | **Successful Count** - Number of signals that achieved targets |
| `signal_accuracy` | DECIMAL(5,4) | NULL | **Accuracy Rate** - Percentage of correct directional predictions |
| `avg_confidence` | DECIMAL(5,4) | NULL | **Average Confidence** - Mean confidence score across all signals |
| `sharpe_ratio` | DECIMAL(8,4) | NULL | **Risk-Adjusted Return** - Sharpe ratio for the evaluation period |
| `max_drawdown` | DECIMAL(8,4) | NULL | **Maximum Drawdown** - Largest peak-to-trough decline |
| `total_return` | DECIMAL(8,4) | NULL | **Total Return** - Cumulative return for the period |
| `volatility` | DECIMAL(8,4) | NULL | **Return Volatility** - Standard deviation of returns |
| `win_rate` | DECIMAL(5,4) | NULL | **Win Rate** - Percentage of profitable signals |
| `avg_holding_period_hours` | DECIMAL(8,2) | NULL | **Average Duration** - Mean holding period for signals |
| `risk_adjusted_return` | DECIMAL(8,4) | NULL | **Risk-Adjusted Performance** - Return per unit of risk |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When performance metrics were calculated |

**Performance Indexes**:
- `idx_model_performance_model_period`: Model-specific performance history
- `idx_model_performance_sharpe`: Ranking models by risk-adjusted performance

---

## Table 10: `rl_episodes` - Reinforcement Learning Training Data

**Purpose**: Store detailed reinforcement learning episode data for training analysis and debugging.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `episode_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Episode ID** - Auto-generated identifier for each RL training episode |
| `session_id` | UUID | NOT NULL, FOREIGN KEY → training_sessions(session_id) | **Training Session** - Links episode to specific training session |
| `episode_number` | INTEGER | NOT NULL | **Episode Sequence** - Sequential episode number within training session |
| `total_reward` | DECIMAL(15,6) | NULL | **Cumulative Reward** - Total reward accumulated during episode |
| `episode_length` | INTEGER | NULL | **Step Count** - Number of actions/steps taken in episode |
| `final_portfolio_value` | DECIMAL(15,6) | NULL | **End Portfolio Value** - Portfolio value at episode completion |
| `max_drawdown` | DECIMAL(8,4) | NULL | **Episode Drawdown** - Maximum decline during episode |
| `actions_taken` | JSONB | NULL | **Action Sequence** - Complete sequence of actions taken |
| `rewards` | JSONB | NULL | **Reward Sequence** - Reward received at each step |
| `episode_end_reason` | VARCHAR(50) | NULL | **Termination Reason** - Why episode ended: 'completed', 'early_stop', 'max_steps', 'failure' |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When episode data was stored |

**Unique Constraint**: `(session_id, episode_number)` - Ensures episode numbering consistency
**Performance Indexes**:
- `idx_rl_episodes_session_number`: Sequential episode analysis
- `idx_rl_episodes_reward`: Performance-based episode ranking

---

## Table 11: `spectrum_analysis` - Frequency Domain Analysis

**Purpose**: Store results from Fourier and wavelet analysis for pattern recognition and market regime detection.

| Field Name | Data Type | Constraints | Purpose & Usage |
|------------|-----------|-------------|-----------------|
| `analysis_id` | UUID | PRIMARY KEY, DEFAULT gen_random_uuid() | **Unique Analysis ID** - Auto-generated identifier for each spectral analysis |
| `model_id` | UUID | NULL, FOREIGN KEY → ai_models(model_id) | **Analysis Model** - Which model performed the spectral analysis |
| `symbol` | VARCHAR(20) | NOT NULL | **Analyzed Symbol** - Trading instrument that was analyzed |
| `analysis_timestamp` | TIMESTAMPTZ | NOT NULL | **Analysis Time** - When spectral analysis was performed |
| `analysis_type` | VARCHAR(50) | NOT NULL | **Analysis Method** - Type: 'fourier', 'wavelet', 'compressed_sensing', 'hilbert_transform' |
| `frequency_components` | JSONB | NULL | **Frequency Data** - Dominant frequencies, amplitudes, and phases found |
| `spectral_features` | JSONB | NULL | **Extracted Features** - Features derived from spectral analysis |
| `pattern_detected` | VARCHAR(100) | NULL | **Named Pattern** - Recognized pattern if identified (e.g., "head_and_shoulders", "cup_and_handle") |
| `pattern_confidence` | DECIMAL(5,4) | NULL | **Pattern Confidence** - Confidence in pattern detection (0.0-1.0) |
| `reconstruction_error` | DECIMAL(15,10) | NULL | **Reconstruction Quality** - Error metric for signal reconstruction |
| `created_at` | TIMESTAMPTZ | DEFAULT NOW() | **Record Creation** - When analysis results were stored |

**Performance Indexes**:
- `idx_spectrum_analysis_symbol_time`: Symbol-specific spectral history
- `idx_spectrum_analysis_type_time`: Analysis method comparison over time

---

## Integration Views

### View 1: `enriched_ai_signals`

**Purpose**: Combines AI signals with performance data and model information for comprehensive analysis.

**Fields Include**:
- All fields from `ai_signals`
- Model metadata from `ai_models` (name, type)
- Performance data from `signal_performance` (actual results)
- Calculated performance metrics

### View 2: `latest_model_performance`

**Purpose**: Provides most recent performance snapshot for all active models.

**Fields Include**:
- Model identification and metadata
- Latest performance metrics
- Evaluation period information
- Active status filtering

---

## Data Relationships Summary

**Primary Relationships**:
1. `ai_models` → `training_sessions` (1:many)
2. `ai_models` → `ai_signals` (1:many)
3. `ai_signals` → `signal_performance` (1:many)
4. `training_sessions` → `rl_episodes` (1:many)
5. `optimization_runs` → `optimization_individuals` (1:many)

**Business Logic Constraints**:
- All timestamps use TIMESTAMPTZ for timezone awareness
- UUIDs provide globally unique identifiers
- JSONB fields enable flexible schema evolution
- Indexes optimized for time-series and symbol-based queries
- Foreign key constraints maintain referential integrity

This comprehensive field reference provides the foundation for understanding how each piece of data contributes to the AI trading system's functionality and business intelligence capabilities.
